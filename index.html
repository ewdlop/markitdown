<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MarkItDown - æ–‡ä»¶è½‰ Markdown å·¥å…·</title>
    <link rel="stylesheet" href="./website/style.css">
    <script src="https://cdn.jsdelivr.net/pyodide/v0.26.4/full/pyodide.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <div class="header-top">
                <h1>ğŸ”„ MarkItDown</h1>
                <div class="language-toggle" role="group" aria-label="Language toggle">
                    <button type="button" class="lang-button active" data-lang="zh">ä¸­æ–‡</button>
                    <button type="button" class="lang-button" data-lang="en">English</button>
                </div>
            </div>
            <p class="subtitle" data-i18n="subtitle">å°‡å„ç¨®æ–‡ä»¶æ ¼å¼è½‰æ›ç‚º Markdown</p>
        </header>

        <main>
            <section class="upload-section">
                <div class="drop-zone" id="dropZone">
                    <div class="drop-zone-content">
                        <svg class="upload-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                            <polyline points="17 8 12 3 7 8"></polyline>
                            <line x1="12" y1="3" x2="12" y2="15"></line>
                        </svg>
                        <h3 data-i18n="dropTitle">æ‹–æ”¾æ–‡ä»¶åˆ°é€™è£¡</h3>
                        <p data-i18n="dropOr">æˆ–</p>
                        <label for="fileInput" class="file-button" data-i18n="chooseFile">é¸æ“‡æ–‡ä»¶</label>
                        <input type="file" id="fileInput" accept=".pdf,.docx,.pptx,.xlsx,.xls,.jpg,.jpeg,.png,.html,.csv,.json,.xml,.txt,.zip,.epub" multiple hidden>
                        <p class="supported-formats" data-i18n="supportedFormats">æ”¯æ´æ ¼å¼: PDF, Word, PowerPoint, Excel, åœ–ç‰‡, HTML, CSV, JSON, XML, ZIP, EPUB ç­‰</p>
                    </div>
                </div>
            </section>

            <section class="status-section" id="statusSection">
                <div class="status-message" id="statusMessage">
                    <div class="loading-spinner"></div>
                    <span id="statusText" data-i18n="status.initializing">åˆå§‹åŒ– Python ç’°å¢ƒä¸­...</span>
                </div>
            </section>

            <section class="info-section" id="infoSection">
                <div class="info-icon">â„¹ï¸</div>
                <div class="info-content">
                    <h3 data-i18n="limitationsTitle">âš ï¸ Microsoft MarkItDown éœæ…‹ç‰ˆé™åˆ¶</h3>
                    <p data-i18n="limitationsText1">æ­¤ç€è¦½å™¨ç‰ˆåƒ…æ”¯æ´ç´”æ–‡å­—èˆ‡éƒ¨åˆ†ç°¡å–®æ ¼å¼ã€‚PDFã€Officeã€åœ–ç‰‡ã€éŸ³è¨Šç­‰é€²éšæ ¼å¼éœ€è¦æ–¼å®Œæ•´çš„ Microsoft MarkItDown Python/CLI ç’°å¢ƒä¸­åŸ·è¡Œã€‚</p>
                    <p data-i18n="limitationsText2">è‹¥éœ€å®Œæ•´è½‰æ›èƒ½åŠ›ï¼Œè«‹åœ¨æœ¬æ©Ÿå®‰è£å¥—ä»¶æˆ–ä½¿ç”¨å‘½ä»¤åˆ—ï¼šmarkitdown your-file.pdf -o output.md</p>
                    <div class="ai-warning" data-i18n="limitationsReasonIntro">ä»¥ä¸‹é™åˆ¶èªªæ˜ç”± AI ç”Ÿæˆï¼Œæ¶µè“‹ç€è¦½å™¨ç‰ˆç„¡æ³•æ”¯æ´é€²éšæ ¼å¼çš„åŸå› ï¼š</div>
                    <ul class="limitations-list">
                        <li data-i18n="limitationsReason1">ç¼ºä¹åŸç”Ÿä¾è³´æ”¯æ´ï¼šMarkItDown çš„ PDFã€Officeã€åœ–ç‰‡ã€éŸ³è¨Šè½‰æ›éœ€è¦å¤šå€‹ C/C++ å¥—ä»¶ï¼Œè€Œ Pyodide åªèƒ½è¼‰å…¥ç´” Python æˆ– WebAssembly å¥—ä»¶ã€‚</li>
                        <li data-i18n="limitationsReason2">ç€è¦½å™¨æ²™ç®±é™åˆ¶ï¼šéœæ…‹é é¢ç„¡æ³•å‘¼å«ç³»çµ±å·¥å…·æˆ–å­˜å–ä½œæ¥­ç³»çµ±è³‡æºï¼Œè¨±å¤šé«˜éšåŠŸèƒ½å› æ­¤å—é™ã€‚</li>
                        <li data-i18n="limitationsReason3">è³‡æºèˆ‡æ•ˆèƒ½è€ƒé‡ï¼šå³ä½¿è½‰æˆ WebAssemblyï¼Œè¼‰å…¥é«”ç©èˆ‡åˆå§‹åŒ–æ™‚é–“ä¹Ÿéå¤§ï¼Œä¸”ä»æœ‰åŠŸèƒ½ç„¡æ³•å®Œæ•´é‹ä½œã€‚</li>
                    </ul>
                </div>
            </section>

            <section class="remote-section" id="mcpSection">
                <div class="remote-header">
                    <h3 data-i18n="remote.title">é€£ç·šæœ¬æ©Ÿ MarkItDown MCP ä¼ºæœå™¨</h3>
                    <p data-i18n="remote.description">å•Ÿå‹• <code>markitdown-mcp --http --host 127.0.0.1 --port 3001</code> å¾Œï¼Œå¯é€éæœ¬ç¯€è¨­å®šä»¥ AJAX å‘¼å«å®Œæ•´è½‰æ›èƒ½åŠ›ã€‚</p>
                    <p class="remote-hint" data-i18n="remote.proxyHint">âš ï¸ ç€è¦½å™¨è«‹æ±‚éœ€èˆ‡ MCP ä¼ºæœå™¨åŒæºï¼Œæˆ–é€éæœ¬æ©Ÿä»£ç†è½‰é€è‡³ <code>/mcp/</code>ï¼Œæ‰èƒ½é¿å…é æª¢è«‹æ±‚ (OPTIONS) è¢« 405 æ“‹ä¸‹ã€‚</p>
                </div>
                <div class="remote-control">
                    <label class="remote-toggle">
                        <input type="checkbox" id="useMcpToggle">
                        <span data-i18n="remote.toggleLabel">ä½¿ç”¨æœ¬æ©Ÿ MCP ä¼ºæœå™¨é€²è¡Œè½‰æ›</span>
                    </label>
                </div>
                <div class="remote-settings" id="mcpSettings">
                    <label for="mcpServerUrl" data-i18n="remote.serverLabel">ä¼ºæœå™¨ä½å€</label>
                    <div class="remote-input-row">
                        <input type="text" id="mcpServerUrl" value="http://127.0.0.1:3001" autocomplete="off">
                        <button type="button" id="testMcpBtn" class="secondary-button" data-i18n="remote.testButton">æ¸¬è©¦é€£ç·š</button>
                    </div>
                    <div class="remote-proxy-example">
                        <details>
                            <summary data-i18n="remote.proxySummary">å¦‚ä½•è¨­å®šç°¡æ˜“ä»£ç†ï¼Ÿ</summary>
                            <div class="proxy-example">
                                <details>
                                    <summary>Node.js + Express + http-proxy-middleware</summary>
                                    <pre><code>npm install express http-proxy-middleware
node server.js</code></pre>
                                    <pre><code>// server.js
const express = require('express');
const { createProxyMiddleware } = require('http-proxy-middleware');
const path = require('path');

const app = express();
const root = path.join(__dirname, 'website');

app.use(express.static(root));

app.options('/mcp', (req, res) => {
  res.set({
    'Access-Control-Allow-Origin': '*',
    'Access-Control-Allow-Methods': 'POST,OPTIONS',
    'Access-Control-Allow-Headers': 'Content-Type,Accept'
  });
  res.sendStatus(204);
});

app.use(
  '/mcp',
  createProxyMiddleware({
    target: 'http://127.0.0.1:3001',
    changeOrigin: true,
    pathRewrite: { '^/mcp': '/mcp/' }
  })
);

app.listen(8080, () => {
  console.log('http://127.0.0.1:8080');
});</code></pre>
                                </details>
                                <details>
                                    <summary>Python + FastAPI + Uvicorn</summary>
                                    <pre><code>pip install fastapi uvicorn httpx</code></pre>
                                    <pre><code># proxy.py
from fastapi import FastAPI, Request, Response
from fastapi.responses import JSONResponse, PlainTextResponse
from fastapi.staticfiles import StaticFiles
import httpx

app = FastAPI()
app.mount("/", StaticFiles(directory="website", html=True), name="static")

TARGET = "http://127.0.0.1:3001/mcp/"
ALLOWED_ORIGIN = "*"

@app.options("/mcp/", include_in_schema=False)
async def options_mcp():
    headers = {
        "Access-Control-Allow-Origin": ALLOWED_ORIGIN,
        "Access-Control-Allow-Methods": "POST,OPTIONS",
        "Access-Control-Allow-Headers": "Content-Type,Accept",
    }
    return Response(status_code=204, headers=headers)

@app.post("/mcp/", include_in_schema=False)
async def proxy_mcp(request: Request):
    headers = {
        "Access-Control-Allow-Origin": ALLOWED_ORIGIN,
        "Access-Control-Allow-Methods": "POST,OPTIONS",
        "Access-Control-Allow-Headers": "Content-Type,Accept",
        "Vary": "Origin",
    }
    try:
        payload = await request.body()
        async with httpx.AsyncClient() as client:
            resp = await client.post(
                TARGET,
                content=payload,
                headers={"Content-Type": "application/json", "Accept": "application/json, text/event-stream"},
                timeout=15.0,
            )
    except httpx.RequestError as exc:
        return JSONResponse(
            {"error": f"Proxy connection failed: {exc}"},
            status_code=502,
            headers=headers,
        )

    proxied_headers = {key: value for key, value in resp.headers.items() if key.lower().startswith("content-")}
    proxied_headers.update(headers)

    if resp.headers.get("Content-Type", "").startswith("application/json"):
        return JSONResponse(resp.json(), status_code=resp.status_code, headers=proxied_headers)
    return PlainTextResponse(resp.text, status_code=resp.status_code, headers=proxied_headers)</code></pre>
                                    <pre><code>uvicorn proxy:app --host 127.0.0.1 --port 8080 --reload</code></pre>
                                </details>
                            </div>
                        </details>
                    </div>
                    <div class="remote-status" id="mcpStatus" data-i18n="remote.statusIdle">å°šæœªæ¸¬è©¦é€£ç·š</div>
                </div>
            </section>

            <section class="files-section" id="filesSection" style="display: none;">
                <h2 data-i18n="filesSelectedTitle">å·²é¸æ“‡çš„æ–‡ä»¶</h2>
                <div id="filesList" class="files-list"></div>
                <button id="convertBtn" class="convert-button">
                    <svg class="button-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21.5 2v6h-6M2.5 22v-6h6M2 11.5a10 10 0 0 1 18.8-4.3M22 12.5a10 10 0 0 1-18.8 4.2"/>
                    </svg>
                    <span data-i18n="convertButton">é–‹å§‹è½‰æ›</span>
                </button>
            </section>

            <section class="results-section" id="resultsSection" style="display: none;">
                <h2 data-i18n="resultsTitle">è½‰æ›çµæœ</h2>
                <div id="resultsList" class="results-list"></div>
            </section>
        </main>

        <footer>
            <p data-i18n="footerLine1">åŸºæ–¼ <a href="https://github.com/microsoft/markitdown" target="_blank">Microsoft MarkItDown</a> é …ç›®</p>
            <p data-i18n="footerLine2">åœ¨ç€è¦½å™¨ä¸­ä½¿ç”¨ <a href="https://pyodide.org" target="_blank">Pyodide</a> é‹è¡Œ</p>
        </footer>
    </div>

    <script src="./website/app.js"></script>
</body>
</html>

